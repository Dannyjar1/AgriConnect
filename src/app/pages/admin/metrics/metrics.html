<!-- Métricas y Analytics - Admin Panel -->
<div class="p-8 max-w-7xl mx-auto bg-slate-50 min-h-screen">
  
  <!-- Header -->
  <div class="mb-8">
    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-8 rounded-xl shadow-md">
      <h1 class="text-3xl font-bold mb-2 font-epilogue">Métricas y Analytics</h1>
      <p class="text-lg opacity-90 font-noto-sans">Monitorea el rendimiento y crecimiento de la plataforma</p>
    </div>
  </div>

  <!-- Period Selector -->
  <div class="bg-white p-6 rounded-xl shadow-sm mb-8">
    <div class="flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between">
      <h2 class="text-xl font-bold text-gray-900 font-epilogue">Resumen de Métricas</h2>
      
      <div class="flex gap-2">
        @for (option of periodOptions; track option.value) {
          <button 
            (click)="changePeriod(option.value)"
            [class]="'px-4 py-2 rounded-lg font-medium transition-all duration-200 font-noto-sans ' + 
                     (selectedPeriod() === option.value 
                       ? 'bg-indigo-600 text-white shadow-md' 
                       : 'bg-gray-100 text-gray-700 hover:bg-gray-200')">
            {{ option.label }}
          </button>
        }
      </div>
    </div>
  </div>

  @if (isLoading()) {
    <!-- Loading State -->
    <div class="bg-white rounded-xl shadow-sm p-12">
      <div class="text-center">
        <div class="inline-flex items-center gap-3 text-gray-500">
          <svg class="animate-spin h-8 w-8" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span class="text-lg font-noto-sans">Cargando métricas...</span>
        </div>
      </div>
    </div>
  } @else {
    <!-- Metrics Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      @for (metric of metrics(); track metric.title) {
        <div class="bg-white p-6 rounded-xl shadow-sm hover:-translate-y-0.5 hover:shadow-lg transition-all duration-200">
          <!-- Metric Header -->
          <div class="flex items-center justify-between mb-4">
            <div [class]="'w-12 h-12 bg-gradient-to-br ' + getColorClass(metric.color) + ' rounded-xl flex items-center justify-center text-white'">
              <i [class]="metric.icon + ' text-xl'"></i>
            </div>
            
            <!-- Change Indicator -->
            <div [class]="'flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ' + 
                         (metric.changeType === 'increase' 
                           ? 'bg-green-100 text-green-800' 
                           : 'bg-red-100 text-red-800')">
              <i [class]="metric.changeType === 'increase' ? 'fas fa-arrow-up' : 'fas fa-arrow-down'"></i>
              <span>{{ formatChange(metric.change) }}</span>
            </div>
          </div>

          <!-- Metric Value -->
          <div class="mb-2">
            <h3 class="text-3xl font-bold text-gray-900 mb-1 font-epilogue">
              @if (metric.title === 'Ventas del Mes') {
                ${{ formatNumber(metric.value) }}
              } @else if (metric.title === 'Tasa de Conversión') {
                {{ metric.value }}%
              } @else {
                {{ formatNumber(metric.value) }}
              }
            </h3>
            <p class="text-sm font-semibold text-gray-700 font-noto-sans">{{ metric.title }}</p>
          </div>

          <!-- Metric Description -->
          <p class="text-xs text-gray-500 font-noto-sans">{{ metric.description }}</p>
        </div>
      }
    </div>

    <!-- Charts Section -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      
      <!-- Sales Chart -->
      <div class="bg-white p-6 rounded-xl shadow-sm">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-xl font-bold text-gray-900 font-epilogue">Ventas por Día</h3>
          <div class="flex items-center gap-2 text-sm text-gray-500">
            <div class="w-3 h-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full"></div>
            <span class="font-noto-sans">Ingresos</span>
          </div>
        </div>
        
        <!-- Chart Placeholder -->
        <div class="h-64 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg flex items-center justify-center">
          <div class="text-center">
            <i class="fas fa-chart-line text-4xl text-blue-400 mb-4"></i>
            <p class="text-gray-600 font-noto-sans">Gráfico de ventas diarias</p>
            <p class="text-sm text-gray-500 font-noto-sans">Integración con Chart.js pendiente</p>
          </div>
        </div>
      </div>

      <!-- Users Chart -->
      <div class="bg-white p-6 rounded-xl shadow-sm">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-xl font-bold text-gray-900 font-epilogue">Crecimiento de Usuarios</h3>
          <div class="flex items-center gap-2 text-sm text-gray-500">
            <div class="w-3 h-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full"></div>
            <span class="font-noto-sans">Nuevos usuarios</span>
          </div>
        </div>
        
        <!-- Chart Placeholder -->
        <div class="h-64 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg flex items-center justify-center">
          <div class="text-center">
            <i class="fas fa-users text-4xl text-green-400 mb-4"></i>
            <p class="text-gray-600 font-noto-sans">Gráfico de crecimiento de usuarios</p>
            <p class="text-sm text-gray-500 font-noto-sans">Integración con Chart.js pendiente</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Top Products Section -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden mb-8">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-xl font-bold text-gray-900 font-epilogue">Productos Más Vendidos</h3>
        <p class="text-sm text-gray-500 font-noto-sans">Top 5 productos con mejor rendimiento</p>
      </div>
      
      <div class="p-6">
        <div class="space-y-4">
          @for (product of [
            { name: 'Tomates Cherry Orgánicos', sales: 156, revenue: 2340, growth: 12.5 },
            { name: 'Lechuga Hidropónica', sales: 134, revenue: 1876, growth: 8.3 },
            { name: 'Zanahorias Baby', sales: 98, revenue: 1456, growth: -2.1 },
            { name: 'Espinaca Fresca', sales: 87, revenue: 1234, growth: 15.7 },
            { name: 'Brócoli Orgánico', sales: 76, revenue: 1098, growth: 5.4 }
          ]; track product.name; let i = $index) {
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
              <div class="flex items-center gap-4">
                <div class="w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center text-white font-bold text-sm">
                  {{ i + 1 }}
                </div>
                <div>
                  <p class="font-semibold text-gray-900 font-noto-sans">{{ product.name }}</p>
                  <p class="text-sm text-gray-500">{{ product.sales }} unidades vendidas</p>
                </div>
              </div>
              
              <div class="text-right">
                <p class="font-bold text-gray-900 font-noto-sans">${{ product.revenue }}</p>
                <div [class]="'flex items-center gap-1 text-xs font-medium ' + 
                             (product.growth > 0 ? 'text-green-600' : 'text-red-600')">
                  <i [class]="product.growth > 0 ? 'fas fa-arrow-up' : 'fas fa-arrow-down'"></i>
                  <span>{{ abs(product.growth) }}%</span>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-xl font-bold text-gray-900 font-epilogue">Actividad Reciente</h3>
        <p class="text-sm text-gray-500 font-noto-sans">Últimas acciones en la plataforma</p>
      </div>
      
      <div class="p-6">
        <div class="space-y-4">
          @for (activity of [
            { type: 'user', icon: 'fas fa-user-plus', message: 'Nuevo usuario registrado: María González', time: 'Hace 5 minutos', color: 'blue' },
            { type: 'sale', icon: 'fas fa-shopping-cart', message: 'Nueva venta: $45.50 - Tomates Cherry', time: 'Hace 12 minutos', color: 'green' },
            { type: 'product', icon: 'fas fa-box', message: 'Producto agregado: Lechuga Hidropónica', time: 'Hace 1 hora', color: 'purple' },
            { type: 'user', icon: 'fas fa-user-check', message: 'Usuario verificado: Juan Pérez', time: 'Hace 2 horas', color: 'emerald' },
            { type: 'sale', icon: 'fas fa-dollar-sign', message: 'Pago procesado: $123.75', time: 'Hace 3 horas', color: 'amber' }
          ]; track activity.message) {
            <div class="flex items-center gap-4 p-3 hover:bg-gray-50 rounded-lg transition-colors duration-150">
              <div [class]="'w-10 h-10 bg-gradient-to-br ' + getColorClass(activity.color) + ' rounded-full flex items-center justify-center text-white'">
                <i [class]="activity.icon"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-900 font-noto-sans">{{ activity.message }}</p>
                <p class="text-xs text-gray-500">{{ activity.time }}</p>
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  }
</div>