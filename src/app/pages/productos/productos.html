<!-- AgriConnect Productos - Diseño Moderno con TailwindCSS v4 -->
<div class="min-h-screen bg-gradient-agri font-noto-sans">
  
  <!-- Header Navigation -->
  <header class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 lg:px-6 flex items-center justify-between h-20">
      <!-- Logo -->
      <div class="flex items-center space-x-3">
        <div class="w-10 h-10 logo-image rounded-lg"></div>
        <span class="text-2xl font-bold text-agri-green-600 font-epilogue tracking-tight">AgriConnect</span>
      </div>
      
      <!-- Navigation Menu -->
      <nav class="hidden md:flex items-center space-x-8" role="navigation">
        <a routerLink="/marketplace" class="text-gray-600 hover:text-agri-green-600 font-medium px-4 py-2 rounded-lg hover:bg-gray-50 transition-all font-epilogue">Inicio</a>
        <a class="text-agri-green-600 font-semibold px-4 py-2 rounded-lg bg-agri-green-50 font-epilogue">Productos</a>
        <a routerLink="/productores" class="text-gray-600 hover:text-agri-green-600 font-medium px-4 py-2 rounded-lg hover:bg-gray-50 transition-all font-epilogue">Productores</a>
        <!-- Profile Icon -->
        <a routerLink="/profile" 
           class="text-gray-600 hover:text-agri-green-600 p-2 rounded-lg hover:bg-gray-50 transition-all cursor-pointer group"
           role="button"
           aria-label="Ir a mi perfil"
           title="Mi Perfil">
          <div class="w-8 h-8 bg-agri-green-100 rounded-full flex items-center justify-center group-hover:bg-agri-green-200 transition-all">
            <span class="material-icons text-lg text-agri-green-600 group-hover:text-agri-green-700">account_circle</span>
          </div>
        </a>
      </nav>
    </div>
  </header>

  <!-- Main Content Area -->
  <main class="max-w-7xl mx-auto px-4 lg:px-6">
    
    <!-- Hero Section -->
    <section class="py-16 lg:py-20 text-center">
      <div class="max-w-4xl mx-auto">
        <h1 class="text-4xl lg:text-5xl font-black text-gray-900 mb-6 font-epilogue leading-tight">
          <span class="text-gradient-agri">Productos Frescos</span> Ecuatorianos
        </h1>
        <p class="text-xl lg:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto leading-relaxed">
          Descubre la riqueza agrícola del Ecuador organizada por categorías
        </p>
      </div>
    </section>

    @if (isLoading()) {
      <!-- Loading State -->
      <section class="py-16">
        <div class="text-center">
          <div class="w-12 h-12 border-4 border-gray-200 border-t-agri-green-600 rounded-full animate-spin mx-auto mb-4"></div>
          <p class="text-xl text-gray-600">Cargando productos frescos...</p>
        </div>
      </section>
    } @else {
      <!-- Products by Category Sections -->
      @for (categoryData of productsByCategory(); track categoryData.category) {
        <section class="py-8 mb-8">
          <div class="max-w-7xl mx-auto">
            <!-- Category Header -->
            <div class="flex items-center justify-between mb-8">
              <h2 class="text-3xl font-bold text-gray-900 font-epilogue flex items-center">
                <span class="w-10 h-10 bg-agri-green-100 rounded-full flex items-center justify-center mr-4">
                  <span class="material-icons text-agri-green-600 text-xl">category</span>
                </span>
                {{ categoryData.category }}
              </h2>
              <span class="text-sm text-gray-500 bg-gray-100 px-4 py-2 rounded-full font-medium">
                {{ categoryData.products.length }} productos disponibles
              </span>
            </div>

            <!-- Horizontal Scroll Container -->
            <div class="relative">
              <div class="flex gap-6 overflow-x-auto pb-6 snap-x snap-mandatory scrollbar-smooth" 
                   style="scroll-behavior: smooth;">
                @for (product of categoryData.products; track product.id) {
                  <div class="flex-none w-80 snap-start">
                    <div class="card card-hover hover-lift group cursor-pointer" 
                         (click)="navigateToProduct(product.id)"
                         role="button"
                         tabindex="0"
                         [attr.aria-label]="'Ver detalles de ' + product.name"
                         (keydown.enter)="navigateToProduct(product.id)"
                         (keydown.space)="navigateToProduct(product.id)">
                      
                      <!-- Product Image -->
                      <div class="relative aspect-w-4 aspect-h-3 overflow-hidden">
                        <img 
                          [src]="product.images[0] || 'assets/images/placeholder-product.svg'" 
                          [alt]="product.name" 
                          class="w-full h-64 object-cover product-img">
                        
                        <!-- Certification Badge -->
                        <div class="absolute top-4 left-4">
                          @if (product.certifications.length > 0) {
                            <span class="bg-agri-green-600 text-white px-3 py-1 rounded-lg text-xs font-semibold uppercase tracking-wide shadow-md">
                              {{ product.certifications[0] }}
                            </span>
                          }
                        </div>
                        
                        <!-- Province Badge -->
                        <div class="absolute top-4 right-4">
                          <span class="bg-white bg-opacity-90 text-gray-700 px-3 py-1 rounded-lg text-xs font-medium shadow-md">
                            {{ product.province }}
                          </span>
                        </div>
                      </div>
                      
                      <!-- Product Info -->
                      <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-2 font-epilogue leading-tight group-hover:text-agri-green-700 transition-colors">
                          {{ product.name }}
                        </h3>
                        <p class="text-gray-600 mb-4 line-clamp-2 text-sm leading-relaxed">
                          {{ product.description }}
                        </p>
                        
                        <!-- Category and Stock Info -->
                        <div class="flex justify-between items-center mb-4">
                          <span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-lg text-sm font-medium">
                            {{ product.category }}
                          </span>
                          <span class="text-gray-500 text-sm">
                            {{ product.availability }} disponible
                          </span>
                        </div>
                        
                        <!-- Price and Add to Cart -->
                        <div class="flex justify-between items-center">
                          <div>
                            <span class="text-2xl font-bold text-agri-green-600 font-epilogue">
                              ${{ product.price.perUnit }}
                            </span>
                            <span class="text-gray-500 text-sm ml-1">
                              por {{ product.price.unit }}
                            </span>
                          </div>
                          <button 
                            (click)="addToCart(product); $event.stopPropagation()"
                            class="bg-agri-green-600 hover:bg-agri-green-700 text-white font-semibold px-4 py-2 rounded-lg transition-all hover:-translate-y-0.5 flex items-center space-x-2 group-hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-agri-green-500 focus:ring-offset-2"
                            [attr.aria-label]="'Agregar ' + product.name + ' al carrito'">
                            <span class="material-icons text-lg">add_shopping_cart</span>
                            <span class="hidden sm:inline">Agregar</span>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                }
              </div>
              
              <!-- Scroll indicators -->
              @if (categoryData.products.length > 3) {
                <div class="flex justify-center mt-4 space-x-2">
                  @for (product of categoryData.products; track product.id; let i = $index) {
                    <div 
                      class="w-2 h-2 rounded-full transition-all duration-300"
                      [class]="i < 3 ? 'bg-agri-green-500' : 'bg-gray-300'"
                      [attr.aria-label]="'Producto ' + (i + 1) + ' de ' + categoryData.products.length">
                    </div>
                  }
                </div>
              }
            </div>
          </div>
        </section>
      }
    }

    <!-- Call to Action Section -->
    <section class="py-16 text-center">
      <div class="max-w-3xl mx-auto">
        <h2 class="text-3xl font-bold text-gray-900 mb-4 font-epilogue">
          ¿No encuentras lo que buscas?
        </h2>
        <p class="text-xl text-gray-600 mb-8">
          Conecta directamente con productores locales para solicitar productos específicos
        </p>
        <button 
          routerLink="/productores"
          class="bg-agri-green-600 hover:bg-agri-green-700 text-white font-semibold px-8 py-4 rounded-xl transition-all hover:-translate-y-1 shadow-lg hover:shadow-xl">
          Buscar Productores
        </button>
      </div>
    </section>
    
  </main>

  <!-- Footer -->
  <footer class="bg-gray-50 border-t border-gray-200 py-8 mt-16">
    <div class="max-w-7xl mx-auto px-4 lg:px-6 text-center">
      <div class="flex items-center justify-center space-x-3 mb-4">
        <div class="w-8 h-8 logo-image rounded-lg"></div>
        <span class="text-xl font-bold text-agri-green-600 font-epilogue">AgriConnect</span>
      </div>
      <p class="text-gray-600">
        Conectando productores y consumidores para un Ecuador más próspero
      </p>
    </div>
  </footer>
</div>